id: breema_csv_media_image_file
label: Image files from CSV input
migration_tags:
  - Breema CSV

source:
  plugin: csv
  path: 'public://csv/media-image-files.csv'
  header_row_count: 0
  keys:
    - filepath
  column_names:
    0:
      filepath: File path

destination:
  plugin: 'entity:file'
  urlencode: true
  source_path_property: file_source
  destination_path_property: file_dest

process:
  file_source_uri:
    plugin: default_value
    default_value: '/Users/dww/breema/legacy-website/images'
  file_source:
    plugin: concat
    delimiter: /
    source:
      - '@file_source_uri'
      - filepath
  file_dest:
    plugin: callback
    callable: breema_migrate_image_path_to_uri
    source: filepath
  uri:
    plugin: file_copy
    source:
      - '@file_source'
      - '@file_dest'
  filename:
    plugin: callback
    callable: drupal_basename
    source: filepath
  uid:
    plugin: default_value
    default_value: 1

migration_dependencies:
  required: {}
  optional: {}
